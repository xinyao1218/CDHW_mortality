clear
clc


hw90_ssp126=ncread("C:\Users\yaoxin\Desktop\ISIMIP3b\HWS\mme_ssp126_hws90.nc", 'tasmax');
hw92_ssp126=ncread("C:\Users\yaoxin\Desktop\ISIMIP3b\HWS\mme_ssp126_hws92.nc", 'tasmax');
hw95_ssp126=ncread("C:\Users\yaoxin\Desktop\ISIMIP3b\HWS\mme_ssp126_hws95.nc", 'tasmax');
hw97_ssp126=ncread("C:\Users\yaoxin\Desktop\ISIMIP3b\HWS\mme_ssp126_hws97.nc", 'tasmax');
hw99_ssp126=ncread("C:\Users\yaoxin\Desktop\ISIMIP3b\HWS\mme_ssp126_hws99.nc", 'tasmax');


twsa_ssp126=ncread("C:\Users\yaoxin\Desktop\ISIMIP3b\TWSA_DSI\mme_ssp126_twsa_dsi.nc", 'tws');


spi_his=ncread("C:\Users\yaoxin\Desktop\ISIMIP3b\SPI\mme_his_spi.nc", 'pr');
spi_ssp126=ncread("C:\Users\yaoxin\Desktop\ISIMIP3b\SPI\mme_ssp126_spi.nc", 'pr');
spei_his=ncread("C:\Users\yaoxin\Desktop\ISIMIP3b\SPEI\mme_his_spei.nc", 'pr');
spei_ssp126=ncread("C:\Users\yaoxin\Desktop\ISIMIP3b\SPEI\mme_ssp126_spei.nc", 'pr');

spi_ssp126=cat(3, spi_his, spi_ssp126);
spei_ssp126=cat(3, spei_his, spei_ssp126);


clear spi_his spei_his


twsa_ssp126(twsa_ssp126>-0.8)=0;
twsa_ssp126(twsa_ssp126<=-0.8)=abs(twsa_ssp126(twsa_ssp126<=-0.8));


spi_ssp126(spi_ssp126>-1.64)=0;
spi_ssp126(spi_ssp126<=-1.64)=abs(spi_ssp126(spi_ssp126<=-1.64));
spei_ssp126(spei_ssp126>-1.64)=0;
spei_ssp126(spei_ssp126<=-1.64)=abs(spei_ssp126(spei_ssp126<=-1.64));

twsa_ssp126=trans_daily(twsa_ssp126);
spi_ssp126=trans_daily(spi_ssp126);
spei_ssp126=trans_daily(spei_ssp126);



cdhw_90_twsa_ssp126=hw90_ssp126.*twsa_ssp126;
cdhw_92_twsa_ssp126=hw92_ssp126.*twsa_ssp126;
cdhw_95_twsa_ssp126=hw95_ssp126.*twsa_ssp126;
cdhw_97_twsa_ssp126=hw97_ssp126.*twsa_ssp126;
cdhw_99_twsa_ssp126=hw99_ssp126.*twsa_ssp126;
cdhw_90_spi_ssp126=hw90_ssp126.*spi_ssp126;
cdhw_92_spi_ssp126=hw92_ssp126.*spi_ssp126;
cdhw_95_spi_ssp126=hw95_ssp126.*spi_ssp126;
cdhw_97_spi_ssp126=hw97_ssp126.*spi_ssp126;
cdhw_99_spi_ssp126=hw99_ssp126.*spi_ssp126;
cdhw_90_spei_ssp126=hw90_ssp126.*spei_ssp126;
cdhw_92_spei_ssp126=hw92_ssp126.*spei_ssp126;
cdhw_95_spei_ssp126=hw95_ssp126.*spei_ssp126;
cdhw_97_spei_ssp126=hw97_ssp126.*spei_ssp126;
cdhw_99_spei_ssp126=hw99_ssp126.*spei_ssp126;

clear hw90_ssp126 hw92_ssp126 hw95_ssp126 hw97_ssp126 hw99_ssp126
clear twsa_ssp126 spi_ssp126 spei_ssp126


cdhw_frequency_90_twsa_2_ssp126=ones(126,102,160);
cdhw_frequency_92_twsa_2_ssp126=ones(126,102,160);
cdhw_frequency_95_twsa_2_ssp126=ones(126,102,160);
cdhw_frequency_97_twsa_2_ssp126=ones(126,102,160);
cdhw_frequency_99_twsa_2_ssp126=ones(126,102,160);
cdhw_frequency_90_spi_2_ssp126=ones(126,102,160);
cdhw_frequency_92_spi_2_ssp126=ones(126,102,160);
cdhw_frequency_95_spi_2_ssp126=ones(126,102,160);
cdhw_frequency_97_spi_2_ssp126=ones(126,102,160);
cdhw_frequency_99_spi_2_ssp126=ones(126,102,160);
cdhw_frequency_90_spei_2_ssp126=ones(126,102,160);
cdhw_frequency_92_spei_2_ssp126=ones(126,102,160);
cdhw_frequency_95_spei_2_ssp126=ones(126,102,160);
cdhw_frequency_97_spei_2_ssp126=ones(126,102,160);
cdhw_frequency_99_spei_2_ssp126=ones(126,102,160);
cdhw_frequency_90_twsa_3_ssp126=ones(126,102,160);
cdhw_frequency_92_twsa_3_ssp126=ones(126,102,160);
cdhw_frequency_95_twsa_3_ssp126=ones(126,102,160);
cdhw_frequency_97_twsa_3_ssp126=ones(126,102,160);
cdhw_frequency_99_twsa_3_ssp126=ones(126,102,160);
cdhw_frequency_90_spi_3_ssp126=ones(126,102,160);
cdhw_frequency_92_spi_3_ssp126=ones(126,102,160);
cdhw_frequency_95_spi_3_ssp126=ones(126,102,160);
cdhw_frequency_97_spi_3_ssp126=ones(126,102,160);
cdhw_frequency_99_spi_3_ssp126=ones(126,102,160);
cdhw_frequency_90_spei_3_ssp126=ones(126,102,160);
cdhw_frequency_92_spei_3_ssp126=ones(126,102,160);
cdhw_frequency_95_spei_3_ssp126=ones(126,102,160);
cdhw_frequency_97_spei_3_ssp126=ones(126,102,160);
cdhw_frequency_99_spei_3_ssp126=ones(126,102,160);
cdhw_frequency_90_twsa_4_ssp126=ones(126,102,160);
cdhw_frequency_92_twsa_4_ssp126=ones(126,102,160);
cdhw_frequency_95_twsa_4_ssp126=ones(126,102,160);
cdhw_frequency_97_twsa_4_ssp126=ones(126,102,160);
cdhw_frequency_99_twsa_4_ssp126=ones(126,102,160);
cdhw_frequency_90_spi_4_ssp126=ones(126,102,160);
cdhw_frequency_92_spi_4_ssp126=ones(126,102,160);
cdhw_frequency_95_spi_4_ssp126=ones(126,102,160);
cdhw_frequency_97_spi_4_ssp126=ones(126,102,160);
cdhw_frequency_99_spi_4_ssp126=ones(126,102,160);
cdhw_frequency_90_spei_4_ssp126=ones(126,102,160);
cdhw_frequency_92_spei_4_ssp126=ones(126,102,160);
cdhw_frequency_95_spei_4_ssp126=ones(126,102,160);
cdhw_frequency_97_spei_4_ssp126=ones(126,102,160);
cdhw_frequency_99_spei_4_ssp126=ones(126,102,160);

cdhw_duration_90_twsa_2_ssp126=ones(126,102,160);
cdhw_duration_92_twsa_2_ssp126=ones(126,102,160);
cdhw_duration_95_twsa_2_ssp126=ones(126,102,160);
cdhw_duration_97_twsa_2_ssp126=ones(126,102,160);
cdhw_duration_99_twsa_2_ssp126=ones(126,102,160);
cdhw_duration_90_spi_2_ssp126=ones(126,102,160);
cdhw_duration_92_spi_2_ssp126=ones(126,102,160);
cdhw_duration_95_spi_2_ssp126=ones(126,102,160);
cdhw_duration_97_spi_2_ssp126=ones(126,102,160);
cdhw_duration_99_spi_2_ssp126=ones(126,102,160);
cdhw_duration_90_spei_2_ssp126=ones(126,102,160);
cdhw_duration_92_spei_2_ssp126=ones(126,102,160);
cdhw_duration_95_spei_2_ssp126=ones(126,102,160);
cdhw_duration_97_spei_2_ssp126=ones(126,102,160);
cdhw_duration_99_spei_2_ssp126=ones(126,102,160);
cdhw_duration_90_twsa_3_ssp126=ones(126,102,160);
cdhw_duration_92_twsa_3_ssp126=ones(126,102,160);
cdhw_duration_95_twsa_3_ssp126=ones(126,102,160);
cdhw_duration_97_twsa_3_ssp126=ones(126,102,160);
cdhw_duration_99_twsa_3_ssp126=ones(126,102,160);
cdhw_duration_90_spi_3_ssp126=ones(126,102,160);
cdhw_duration_92_spi_3_ssp126=ones(126,102,160);
cdhw_duration_95_spi_3_ssp126=ones(126,102,160);
cdhw_duration_97_spi_3_ssp126=ones(126,102,160);
cdhw_duration_99_spi_3_ssp126=ones(126,102,160);
cdhw_duration_90_spei_3_ssp126=ones(126,102,160);
cdhw_duration_92_spei_3_ssp126=ones(126,102,160);
cdhw_duration_95_spei_3_ssp126=ones(126,102,160);
cdhw_duration_97_spei_3_ssp126=ones(126,102,160);
cdhw_duration_99_spei_3_ssp126=ones(126,102,160);
cdhw_duration_90_twsa_4_ssp126=ones(126,102,160);
cdhw_duration_92_twsa_4_ssp126=ones(126,102,160);
cdhw_duration_95_twsa_4_ssp126=ones(126,102,160);
cdhw_duration_97_twsa_4_ssp126=ones(126,102,160);
cdhw_duration_99_twsa_4_ssp126=ones(126,102,160);
cdhw_duration_90_spi_4_ssp126=ones(126,102,160);
cdhw_duration_92_spi_4_ssp126=ones(126,102,160);
cdhw_duration_95_spi_4_ssp126=ones(126,102,160);
cdhw_duration_97_spi_4_ssp126=ones(126,102,160);
cdhw_duration_99_spi_4_ssp126=ones(126,102,160);
cdhw_duration_90_spei_4_ssp126=ones(126,102,160);
cdhw_duration_92_spei_4_ssp126=ones(126,102,160);
cdhw_duration_95_spei_4_ssp126=ones(126,102,160);
cdhw_duration_97_spei_4_ssp126=ones(126,102,160);
cdhw_duration_99_spei_4_ssp126=ones(126,102,160);

cdhw_severity_90_twsa_2_ssp126=ones(126,102,160);
cdhw_severity_92_twsa_2_ssp126=ones(126,102,160);
cdhw_severity_95_twsa_2_ssp126=ones(126,102,160);
cdhw_severity_97_twsa_2_ssp126=ones(126,102,160);
cdhw_severity_99_twsa_2_ssp126=ones(126,102,160);
cdhw_severity_90_spi_2_ssp126=ones(126,102,160);
cdhw_severity_92_spi_2_ssp126=ones(126,102,160);
cdhw_severity_95_spi_2_ssp126=ones(126,102,160);
cdhw_severity_97_spi_2_ssp126=ones(126,102,160);
cdhw_severity_99_spi_2_ssp126=ones(126,102,160);
cdhw_severity_90_spei_2_ssp126=ones(126,102,160);
cdhw_severity_92_spei_2_ssp126=ones(126,102,160);
cdhw_severity_95_spei_2_ssp126=ones(126,102,160);
cdhw_severity_97_spei_2_ssp126=ones(126,102,160);
cdhw_severity_99_spei_2_ssp126=ones(126,102,160);
cdhw_severity_90_twsa_3_ssp126=ones(126,102,160);
cdhw_severity_92_twsa_3_ssp126=ones(126,102,160);
cdhw_severity_95_twsa_3_ssp126=ones(126,102,160);
cdhw_severity_97_twsa_3_ssp126=ones(126,102,160);
cdhw_severity_99_twsa_3_ssp126=ones(126,102,160);
cdhw_severity_90_spi_3_ssp126=ones(126,102,160);
cdhw_severity_92_spi_3_ssp126=ones(126,102,160);
cdhw_severity_95_spi_3_ssp126=ones(126,102,160);
cdhw_severity_97_spi_3_ssp126=ones(126,102,160);
cdhw_severity_99_spi_3_ssp126=ones(126,102,160);
cdhw_severity_90_spei_3_ssp126=ones(126,102,160);
cdhw_severity_92_spei_3_ssp126=ones(126,102,160);
cdhw_severity_95_spei_3_ssp126=ones(126,102,160);
cdhw_severity_97_spei_3_ssp126=ones(126,102,160);
cdhw_severity_99_spei_3_ssp126=ones(126,102,160);
cdhw_severity_90_twsa_4_ssp126=ones(126,102,160);
cdhw_severity_92_twsa_4_ssp126=ones(126,102,160);
cdhw_severity_95_twsa_4_ssp126=ones(126,102,160);
cdhw_severity_97_twsa_4_ssp126=ones(126,102,160);
cdhw_severity_99_twsa_4_ssp126=ones(126,102,160);
cdhw_severity_90_spi_4_ssp126=ones(126,102,160);
cdhw_severity_92_spi_4_ssp126=ones(126,102,160);
cdhw_severity_95_spi_4_ssp126=ones(126,102,160);
cdhw_severity_97_spi_4_ssp126=ones(126,102,160);
cdhw_severity_99_spi_4_ssp126=ones(126,102,160);
cdhw_severity_90_spei_4_ssp126=ones(126,102,160);
cdhw_severity_92_spei_4_ssp126=ones(126,102,160);
cdhw_severity_95_spei_4_ssp126=ones(126,102,160);
cdhw_severity_97_spei_4_ssp126=ones(126,102,160);
cdhw_severity_99_spei_4_ssp126=ones(126,102,160);


for i=1:160
    for j=1:126
        for k=1:102
            cdhw_frequency_90_twsa_2_ssp126(j,k,i)=cdhw_frequency(cdhw_90_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_92_twsa_2_ssp126(j,k,i)=cdhw_frequency(cdhw_92_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_95_twsa_2_ssp126(j,k,i)=cdhw_frequency(cdhw_95_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_97_twsa_2_ssp126(j,k,i)=cdhw_frequency(cdhw_97_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_99_twsa_2_ssp126(j,k,i)=cdhw_frequency(cdhw_99_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_90_spi_2_ssp126(j,k,i)=cdhw_frequency(cdhw_90_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_92_spi_2_ssp126(j,k,i)=cdhw_frequency(cdhw_92_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_95_spi_2_ssp126(j,k,i)=cdhw_frequency(cdhw_95_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_97_spi_2_ssp126(j,k,i)=cdhw_frequency(cdhw_97_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_99_spi_2_ssp126(j,k,i)=cdhw_frequency(cdhw_99_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_90_spei_2_ssp126(j,k,i)=cdhw_frequency(cdhw_90_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_92_spei_2_ssp126(j,k,i)=cdhw_frequency(cdhw_92_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_95_spei_2_ssp126(j,k,i)=cdhw_frequency(cdhw_95_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_97_spei_2_ssp126(j,k,i)=cdhw_frequency(cdhw_97_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_99_spei_2_ssp126(j,k,i)=cdhw_frequency(cdhw_99_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_frequency_90_twsa_3_ssp126(j,k,i)=cdhw_frequency(cdhw_90_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_92_twsa_3_ssp126(j,k,i)=cdhw_frequency(cdhw_92_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_95_twsa_3_ssp126(j,k,i)=cdhw_frequency(cdhw_95_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_97_twsa_3_ssp126(j,k,i)=cdhw_frequency(cdhw_97_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_99_twsa_3_ssp126(j,k,i)=cdhw_frequency(cdhw_99_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_90_spi_3_ssp126(j,k,i)=cdhw_frequency(cdhw_90_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_92_spi_3_ssp126(j,k,i)=cdhw_frequency(cdhw_92_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_95_spi_3_ssp126(j,k,i)=cdhw_frequency(cdhw_95_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_97_spi_3_ssp126(j,k,i)=cdhw_frequency(cdhw_97_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_99_spi_3_ssp126(j,k,i)=cdhw_frequency(cdhw_99_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_90_spei_3_ssp126(j,k,i)=cdhw_frequency(cdhw_90_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_92_spei_3_ssp126(j,k,i)=cdhw_frequency(cdhw_92_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_95_spei_3_ssp126(j,k,i)=cdhw_frequency(cdhw_95_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_97_spei_3_ssp126(j,k,i)=cdhw_frequency(cdhw_97_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_99_spei_3_ssp126(j,k,i)=cdhw_frequency(cdhw_99_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_frequency_90_twsa_4_ssp126(j,k,i)=cdhw_frequency(cdhw_90_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_92_twsa_4_ssp126(j,k,i)=cdhw_frequency(cdhw_92_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_95_twsa_4_ssp126(j,k,i)=cdhw_frequency(cdhw_95_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_97_twsa_4_ssp126(j,k,i)=cdhw_frequency(cdhw_97_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_99_twsa_4_ssp126(j,k,i)=cdhw_frequency(cdhw_99_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_90_spi_4_ssp126(j,k,i)=cdhw_frequency(cdhw_90_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_92_spi_4_ssp126(j,k,i)=cdhw_frequency(cdhw_92_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_95_spi_4_ssp126(j,k,i)=cdhw_frequency(cdhw_95_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_97_spi_4_ssp126(j,k,i)=cdhw_frequency(cdhw_97_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_99_spi_4_ssp126(j,k,i)=cdhw_frequency(cdhw_99_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_90_spei_4_ssp126(j,k,i)=cdhw_frequency(cdhw_90_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_92_spei_4_ssp126(j,k,i)=cdhw_frequency(cdhw_92_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_95_spei_4_ssp126(j,k,i)=cdhw_frequency(cdhw_95_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_97_spei_4_ssp126(j,k,i)=cdhw_frequency(cdhw_97_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_frequency_99_spei_4_ssp126(j,k,i)=cdhw_frequency(cdhw_99_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_90_twsa_2_ssp126(j,k,i)=cdhw_duration(cdhw_90_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_92_twsa_2_ssp126(j,k,i)=cdhw_duration(cdhw_92_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_95_twsa_2_ssp126(j,k,i)=cdhw_duration(cdhw_95_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_97_twsa_2_ssp126(j,k,i)=cdhw_duration(cdhw_97_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_99_twsa_2_ssp126(j,k,i)=cdhw_duration(cdhw_99_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_90_spi_2_ssp126(j,k,i)=cdhw_duration(cdhw_90_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_92_spi_2_ssp126(j,k,i)=cdhw_duration(cdhw_92_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_95_spi_2_ssp126(j,k,i)=cdhw_duration(cdhw_95_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_97_spi_2_ssp126(j,k,i)=cdhw_duration(cdhw_97_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_99_spi_2_ssp126(j,k,i)=cdhw_duration(cdhw_99_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_90_spei_2_ssp126(j,k,i)=cdhw_duration(cdhw_90_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_92_spei_2_ssp126(j,k,i)=cdhw_duration(cdhw_92_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_95_spei_2_ssp126(j,k,i)=cdhw_duration(cdhw_95_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_97_spei_2_ssp126(j,k,i)=cdhw_duration(cdhw_97_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_99_spei_2_ssp126(j,k,i)=cdhw_duration(cdhw_99_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_duration_90_twsa_3_ssp126(j,k,i)=cdhw_duration(cdhw_90_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_92_twsa_3_ssp126(j,k,i)=cdhw_duration(cdhw_92_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_95_twsa_3_ssp126(j,k,i)=cdhw_duration(cdhw_95_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_97_twsa_3_ssp126(j,k,i)=cdhw_duration(cdhw_97_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_99_twsa_3_ssp126(j,k,i)=cdhw_duration(cdhw_99_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_90_spi_3_ssp126(j,k,i)=cdhw_duration(cdhw_90_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_92_spi_3_ssp126(j,k,i)=cdhw_duration(cdhw_92_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_95_spi_3_ssp126(j,k,i)=cdhw_duration(cdhw_95_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_97_spi_3_ssp126(j,k,i)=cdhw_duration(cdhw_97_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_99_spi_3_ssp126(j,k,i)=cdhw_duration(cdhw_99_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_90_spei_3_ssp126(j,k,i)=cdhw_duration(cdhw_90_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_92_spei_3_ssp126(j,k,i)=cdhw_duration(cdhw_92_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_95_spei_3_ssp126(j,k,i)=cdhw_duration(cdhw_95_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_97_spei_3_ssp126(j,k,i)=cdhw_duration(cdhw_97_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_99_spei_3_ssp126(j,k,i)=cdhw_duration(cdhw_99_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_duration_90_twsa_4_ssp126(j,k,i)=cdhw_duration(cdhw_90_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_92_twsa_4_ssp126(j,k,i)=cdhw_duration(cdhw_92_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_95_twsa_4_ssp126(j,k,i)=cdhw_duration(cdhw_95_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_97_twsa_4_ssp126(j,k,i)=cdhw_duration(cdhw_97_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_99_twsa_4_ssp126(j,k,i)=cdhw_duration(cdhw_99_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_90_spi_4_ssp126(j,k,i)=cdhw_duration(cdhw_90_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_92_spi_4_ssp126(j,k,i)=cdhw_duration(cdhw_92_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_95_spi_4_ssp126(j,k,i)=cdhw_duration(cdhw_95_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_97_spi_4_ssp126(j,k,i)=cdhw_duration(cdhw_97_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_99_spi_4_ssp126(j,k,i)=cdhw_duration(cdhw_99_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_90_spei_4_ssp126(j,k,i)=cdhw_duration(cdhw_90_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_92_spei_4_ssp126(j,k,i)=cdhw_duration(cdhw_92_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_95_spei_4_ssp126(j,k,i)=cdhw_duration(cdhw_95_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_97_spei_4_ssp126(j,k,i)=cdhw_duration(cdhw_97_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_duration_99_spei_4_ssp126(j,k,i)=cdhw_duration(cdhw_99_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_90_twsa_2_ssp126(j,k,i)=cdhw_severity(cdhw_90_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_92_twsa_2_ssp126(j,k,i)=cdhw_severity(cdhw_92_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_95_twsa_2_ssp126(j,k,i)=cdhw_severity(cdhw_95_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_97_twsa_2_ssp126(j,k,i)=cdhw_severity(cdhw_97_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_99_twsa_2_ssp126(j,k,i)=cdhw_severity(cdhw_99_twsa_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_90_spi_2_ssp126(j,k,i)=cdhw_severity(cdhw_90_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_92_spi_2_ssp126(j,k,i)=cdhw_severity(cdhw_92_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_95_spi_2_ssp126(j,k,i)=cdhw_severity(cdhw_95_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_97_spi_2_ssp126(j,k,i)=cdhw_severity(cdhw_97_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_99_spi_2_ssp126(j,k,i)=cdhw_severity(cdhw_99_spi_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_90_spei_2_ssp126(j,k,i)=cdhw_severity(cdhw_90_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_92_spei_2_ssp126(j,k,i)=cdhw_severity(cdhw_92_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_95_spei_2_ssp126(j,k,i)=cdhw_severity(cdhw_95_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_97_spei_2_ssp126(j,k,i)=cdhw_severity(cdhw_97_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_99_spei_2_ssp126(j,k,i)=cdhw_severity(cdhw_99_spei_ssp126(j,k,365*(i-1)+1:365*i),2);
            cdhw_severity_90_twsa_3_ssp126(j,k,i)=cdhw_severity(cdhw_90_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_92_twsa_3_ssp126(j,k,i)=cdhw_severity(cdhw_92_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_95_twsa_3_ssp126(j,k,i)=cdhw_severity(cdhw_95_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_97_twsa_3_ssp126(j,k,i)=cdhw_severity(cdhw_97_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_99_twsa_3_ssp126(j,k,i)=cdhw_severity(cdhw_99_twsa_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_90_spi_3_ssp126(j,k,i)=cdhw_severity(cdhw_90_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_92_spi_3_ssp126(j,k,i)=cdhw_severity(cdhw_92_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_95_spi_3_ssp126(j,k,i)=cdhw_severity(cdhw_95_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_97_spi_3_ssp126(j,k,i)=cdhw_severity(cdhw_97_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_99_spi_3_ssp126(j,k,i)=cdhw_severity(cdhw_99_spi_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_90_spei_3_ssp126(j,k,i)=cdhw_severity(cdhw_90_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_92_spei_3_ssp126(j,k,i)=cdhw_severity(cdhw_92_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_95_spei_3_ssp126(j,k,i)=cdhw_severity(cdhw_95_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_97_spei_3_ssp126(j,k,i)=cdhw_severity(cdhw_97_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_99_spei_3_ssp126(j,k,i)=cdhw_severity(cdhw_99_spei_ssp126(j,k,365*(i-1)+1:365*i),3);
            cdhw_severity_90_twsa_4_ssp126(j,k,i)=cdhw_severity(cdhw_90_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_92_twsa_4_ssp126(j,k,i)=cdhw_severity(cdhw_92_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_95_twsa_4_ssp126(j,k,i)=cdhw_severity(cdhw_95_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_97_twsa_4_ssp126(j,k,i)=cdhw_severity(cdhw_97_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_99_twsa_4_ssp126(j,k,i)=cdhw_severity(cdhw_99_twsa_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_90_spi_4_ssp126(j,k,i)=cdhw_severity(cdhw_90_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_92_spi_4_ssp126(j,k,i)=cdhw_severity(cdhw_92_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_95_spi_4_ssp126(j,k,i)=cdhw_severity(cdhw_95_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_97_spi_4_ssp126(j,k,i)=cdhw_severity(cdhw_97_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_99_spi_4_ssp126(j,k,i)=cdhw_severity(cdhw_99_spi_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_90_spei_4_ssp126(j,k,i)=cdhw_severity(cdhw_90_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_92_spei_4_ssp126(j,k,i)=cdhw_severity(cdhw_92_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_95_spei_4_ssp126(j,k,i)=cdhw_severity(cdhw_95_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_97_spei_4_ssp126(j,k,i)=cdhw_severity(cdhw_97_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
            cdhw_severity_99_spei_4_ssp126(j,k,i)=cdhw_severity(cdhw_99_spei_ssp126(j,k,365*(i-1)+1:365*i),4);
        end
    end
end



ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_90_twsa_2_ssp126.nc", 'tws', cdhw_frequency_90_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_92_twsa_2_ssp126.nc", 'tws', cdhw_frequency_92_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_95_twsa_2_ssp126.nc", 'tws', cdhw_frequency_95_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_97_twsa_2_ssp126.nc", 'tws', cdhw_frequency_97_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_99_twsa_2_ssp126.nc", 'tws', cdhw_frequency_99_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_90_spi_2_ssp126.nc", 'tws', cdhw_frequency_90_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_92_spi_2_ssp126.nc", 'tws', cdhw_frequency_92_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_95_spi_2_ssp126.nc", 'tws', cdhw_frequency_95_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_97_spi_2_ssp126.nc", 'tws', cdhw_frequency_97_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_99_spi_2_ssp126.nc", 'tws', cdhw_frequency_99_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_90_spei_2_ssp126.nc", 'tws', cdhw_frequency_90_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_92_spei_2_ssp126.nc", 'tws', cdhw_frequency_92_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_95_spei_2_ssp126.nc", 'tws', cdhw_frequency_95_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_97_spei_2_ssp126.nc", 'tws', cdhw_frequency_97_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_99_spei_2_ssp126.nc", 'tws', cdhw_frequency_99_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_90_twsa_3_ssp126.nc", 'tws', cdhw_frequency_90_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_92_twsa_3_ssp126.nc", 'tws', cdhw_frequency_92_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_95_twsa_3_ssp126.nc", 'tws', cdhw_frequency_95_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_97_twsa_3_ssp126.nc", 'tws', cdhw_frequency_97_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_99_twsa_3_ssp126.nc", 'tws', cdhw_frequency_99_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_90_spi_3_ssp126.nc", 'tws', cdhw_frequency_90_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_92_spi_3_ssp126.nc", 'tws', cdhw_frequency_92_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_95_spi_3_ssp126.nc", 'tws', cdhw_frequency_95_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_97_spi_3_ssp126.nc", 'tws', cdhw_frequency_97_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_99_spi_3_ssp126.nc", 'tws', cdhw_frequency_99_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_90_spei_3_ssp126.nc", 'tws', cdhw_frequency_90_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_92_spei_3_ssp126.nc", 'tws', cdhw_frequency_92_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_95_spei_3_ssp126.nc", 'tws', cdhw_frequency_95_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_97_spei_3_ssp126.nc", 'tws', cdhw_frequency_97_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_99_spei_3_ssp126.nc", 'tws', cdhw_frequency_99_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_90_twsa_4_ssp126.nc", 'tws', cdhw_frequency_90_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_92_twsa_4_ssp126.nc", 'tws', cdhw_frequency_92_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_95_twsa_4_ssp126.nc", 'tws', cdhw_frequency_95_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_97_twsa_4_ssp126.nc", 'tws', cdhw_frequency_97_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_99_twsa_4_ssp126.nc", 'tws', cdhw_frequency_99_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_90_spi_4_ssp126.nc", 'tws', cdhw_frequency_90_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_92_spi_4_ssp126.nc", 'tws', cdhw_frequency_92_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_95_spi_4_ssp126.nc", 'tws', cdhw_frequency_95_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_97_spi_4_ssp126.nc", 'tws', cdhw_frequency_97_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_99_spi_4_ssp126.nc", 'tws', cdhw_frequency_99_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_90_spei_4_ssp126.nc", 'tws', cdhw_frequency_90_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_92_spei_4_ssp126.nc", 'tws', cdhw_frequency_92_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_95_spei_4_ssp126.nc", 'tws', cdhw_frequency_95_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_97_spei_4_ssp126.nc", 'tws', cdhw_frequency_97_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_frequency_99_spei_4_ssp126.nc", 'tws', cdhw_frequency_99_spei_4_ssp126);

ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_90_twsa_2_ssp126.nc", 'tws', cdhw_duration_90_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_92_twsa_2_ssp126.nc", 'tws', cdhw_duration_92_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_95_twsa_2_ssp126.nc", 'tws', cdhw_duration_95_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_97_twsa_2_ssp126.nc", 'tws', cdhw_duration_97_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_99_twsa_2_ssp126.nc", 'tws', cdhw_duration_99_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_90_spi_2_ssp126.nc", 'tws', cdhw_duration_90_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_92_spi_2_ssp126.nc", 'tws', cdhw_duration_92_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_95_spi_2_ssp126.nc", 'tws', cdhw_duration_95_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_97_spi_2_ssp126.nc", 'tws', cdhw_duration_97_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_99_spi_2_ssp126.nc", 'tws', cdhw_duration_99_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_90_spei_2_ssp126.nc", 'tws', cdhw_duration_90_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_92_spei_2_ssp126.nc", 'tws', cdhw_duration_92_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_95_spei_2_ssp126.nc", 'tws', cdhw_duration_95_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_97_spei_2_ssp126.nc", 'tws', cdhw_duration_97_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_99_spei_2_ssp126.nc", 'tws', cdhw_duration_99_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_90_twsa_3_ssp126.nc", 'tws', cdhw_duration_90_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_92_twsa_3_ssp126.nc", 'tws', cdhw_duration_92_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_95_twsa_3_ssp126.nc", 'tws', cdhw_duration_95_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_97_twsa_3_ssp126.nc", 'tws', cdhw_duration_97_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_99_twsa_3_ssp126.nc", 'tws', cdhw_duration_99_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_90_spi_3_ssp126.nc", 'tws', cdhw_duration_90_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_92_spi_3_ssp126.nc", 'tws', cdhw_duration_92_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_95_spi_3_ssp126.nc", 'tws', cdhw_duration_95_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_97_spi_3_ssp126.nc", 'tws', cdhw_duration_97_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_99_spi_3_ssp126.nc", 'tws', cdhw_duration_99_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_90_spei_3_ssp126.nc", 'tws', cdhw_duration_90_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_92_spei_3_ssp126.nc", 'tws', cdhw_duration_92_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_95_spei_3_ssp126.nc", 'tws', cdhw_duration_95_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_97_spei_3_ssp126.nc", 'tws', cdhw_duration_97_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_99_spei_3_ssp126.nc", 'tws', cdhw_duration_99_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_90_twsa_4_ssp126.nc", 'tws', cdhw_duration_90_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_92_twsa_4_ssp126.nc", 'tws', cdhw_duration_92_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_95_twsa_4_ssp126.nc", 'tws', cdhw_duration_95_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_97_twsa_4_ssp126.nc", 'tws', cdhw_duration_97_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_99_twsa_4_ssp126.nc", 'tws', cdhw_duration_99_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_90_spi_4_ssp126.nc", 'tws', cdhw_duration_90_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_92_spi_4_ssp126.nc", 'tws', cdhw_duration_92_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_95_spi_4_ssp126.nc", 'tws', cdhw_duration_95_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_97_spi_4_ssp126.nc", 'tws', cdhw_duration_97_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_99_spi_4_ssp126.nc", 'tws', cdhw_duration_99_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_90_spei_4_ssp126.nc", 'tws', cdhw_duration_90_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_92_spei_4_ssp126.nc", 'tws', cdhw_duration_92_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_95_spei_4_ssp126.nc", 'tws', cdhw_duration_95_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_97_spei_4_ssp126.nc", 'tws', cdhw_duration_97_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_duration_99_spei_4_ssp126.nc", 'tws', cdhw_duration_99_spei_4_ssp126);

ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_90_twsa_2_ssp126.nc", 'tws', cdhw_severity_90_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_92_twsa_2_ssp126.nc", 'tws', cdhw_severity_92_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_95_twsa_2_ssp126.nc", 'tws', cdhw_severity_95_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_97_twsa_2_ssp126.nc", 'tws', cdhw_severity_97_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_99_twsa_2_ssp126.nc", 'tws', cdhw_severity_99_twsa_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_90_spi_2_ssp126.nc", 'tws', cdhw_severity_90_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_92_spi_2_ssp126.nc", 'tws', cdhw_severity_92_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_95_spi_2_ssp126.nc", 'tws', cdhw_severity_95_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_97_spi_2_ssp126.nc", 'tws', cdhw_severity_97_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_99_spi_2_ssp126.nc", 'tws', cdhw_severity_99_spi_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_90_spei_2_ssp126.nc", 'tws', cdhw_severity_90_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_92_spei_2_ssp126.nc", 'tws', cdhw_severity_92_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_95_spei_2_ssp126.nc", 'tws', cdhw_severity_95_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_97_spei_2_ssp126.nc", 'tws', cdhw_severity_97_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_99_spei_2_ssp126.nc", 'tws', cdhw_severity_99_spei_2_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_90_twsa_3_ssp126.nc", 'tws', cdhw_severity_90_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_92_twsa_3_ssp126.nc", 'tws', cdhw_severity_92_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_95_twsa_3_ssp126.nc", 'tws', cdhw_severity_95_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_97_twsa_3_ssp126.nc", 'tws', cdhw_severity_97_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_99_twsa_3_ssp126.nc", 'tws', cdhw_severity_99_twsa_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_90_spi_3_ssp126.nc", 'tws', cdhw_severity_90_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_92_spi_3_ssp126.nc", 'tws', cdhw_severity_92_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_95_spi_3_ssp126.nc", 'tws', cdhw_severity_95_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_97_spi_3_ssp126.nc", 'tws', cdhw_severity_97_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_99_spi_3_ssp126.nc", 'tws', cdhw_severity_99_spi_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_90_spei_3_ssp126.nc", 'tws', cdhw_severity_90_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_92_spei_3_ssp126.nc", 'tws', cdhw_severity_92_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_95_spei_3_ssp126.nc", 'tws', cdhw_severity_95_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_97_spei_3_ssp126.nc", 'tws', cdhw_severity_97_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_99_spei_3_ssp126.nc", 'tws', cdhw_severity_99_spei_3_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_90_twsa_4_ssp126.nc", 'tws', cdhw_severity_90_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_92_twsa_4_ssp126.nc", 'tws', cdhw_severity_92_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_95_twsa_4_ssp126.nc", 'tws', cdhw_severity_95_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_97_twsa_4_ssp126.nc", 'tws', cdhw_severity_97_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_99_twsa_4_ssp126.nc", 'tws', cdhw_severity_99_twsa_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_90_spi_4_ssp126.nc", 'tws', cdhw_severity_90_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_92_spi_4_ssp126.nc", 'tws', cdhw_severity_92_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_95_spi_4_ssp126.nc", 'tws', cdhw_severity_95_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_97_spi_4_ssp126.nc", 'tws', cdhw_severity_97_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_99_spi_4_ssp126.nc", 'tws', cdhw_severity_99_spi_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_90_spei_4_ssp126.nc", 'tws', cdhw_severity_90_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_92_spei_4_ssp126.nc", 'tws', cdhw_severity_92_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_95_spei_4_ssp126.nc", 'tws', cdhw_severity_95_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_97_spei_4_ssp126.nc", 'tws', cdhw_severity_97_spei_4_ssp126);
ncwrite("C:\Users\yaoxin\Desktop\ISIMIP3b\CDHW_index_yearly\cdhw_severity_99_spei_4_ssp126.nc", 'tws', cdhw_severity_99_spei_4_ssp126);

