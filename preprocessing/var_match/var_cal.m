clear
clc

load("C:\Users\yaoxin\Desktop\匹配\CLHLS_index\clhls_hw90.mat");
load("C:\Users\yaoxin\Desktop\匹配\CLHLS_index\clhls_hw92.mat");
load("C:\Users\yaoxin\Desktop\匹配\CLHLS_index\clhls_hw95.mat");
load("C:\Users\yaoxin\Desktop\匹配\CLHLS_index\clhls_hw97.mat");
load("C:\Users\yaoxin\Desktop\匹配\CLHLS_index\clhls_hw99.mat");
load("C:\Users\yaoxin\Desktop\匹配\CLHLS_index\clhls_twsa.mat");
load("C:\Users\yaoxin\Desktop\匹配\CLHLS_index\clhls_spi.mat");
load("C:\Users\yaoxin\Desktop\匹配\CLHLS_index\clhls_spei.mat");


cdhw_twsa_90=clhls_hw90.*clhls_twsa;
cdhw_twsa_92=clhls_hw92.*clhls_twsa;
cdhw_twsa_95=clhls_hw95.*clhls_twsa;
cdhw_twsa_97=clhls_hw97.*clhls_twsa;
cdhw_twsa_99=clhls_hw99.*clhls_twsa;

cdhw_spi_90=clhls_hw90.*clhls_spi;
cdhw_spi_92=clhls_hw92.*clhls_spi;
cdhw_spi_95=clhls_hw95.*clhls_spi;
cdhw_spi_97=clhls_hw97.*clhls_spi;
cdhw_spi_99=clhls_hw99.*clhls_spi;

cdhw_spei_90=clhls_hw90.*clhls_spei;
cdhw_spei_92=clhls_hw92.*clhls_spei;
cdhw_spei_95=clhls_hw95.*clhls_spei;
cdhw_spei_97=clhls_hw97.*clhls_spei;
cdhw_spei_99=clhls_hw99.*clhls_spei;


r=length(cdhw_twsa_90);


for i=1:r
    frequency_twsa_90(i,1)=cdhw_frequency(cdhw_twsa_90(i,:),2);
    frequency_twsa_90(i,2)=cdhw_frequency(cdhw_twsa_90(i,:),3);
    frequency_twsa_90(i,3)=cdhw_frequency(cdhw_twsa_90(i,:),4);
    frequency_twsa_92(i,1)=cdhw_frequency(cdhw_twsa_92(i,:),2);
    frequency_twsa_92(i,2)=cdhw_frequency(cdhw_twsa_92(i,:),3);
    frequency_twsa_92(i,3)=cdhw_frequency(cdhw_twsa_92(i,:),4);
    frequency_twsa_95(i,1)=cdhw_frequency(cdhw_twsa_95(i,:),2);
    frequency_twsa_95(i,2)=cdhw_frequency(cdhw_twsa_95(i,:),3);
    frequency_twsa_95(i,3)=cdhw_frequency(cdhw_twsa_95(i,:),4);
    frequency_twsa_97(i,1)=cdhw_frequency(cdhw_twsa_97(i,:),2);
    frequency_twsa_97(i,2)=cdhw_frequency(cdhw_twsa_97(i,:),3);
    frequency_twsa_97(i,3)=cdhw_frequency(cdhw_twsa_97(i,:),4);
    frequency_twsa_99(i,1)=cdhw_frequency(cdhw_twsa_99(i,:),2);
    frequency_twsa_99(i,2)=cdhw_frequency(cdhw_twsa_99(i,:),3);
    frequency_twsa_99(i,3)=cdhw_frequency(cdhw_twsa_99(i,:),4);
    frequency_spi_90(i,1)=cdhw_frequency(cdhw_spi_90(i,:),2);
    frequency_spi_90(i,2)=cdhw_frequency(cdhw_spi_90(i,:),3);
    frequency_spi_90(i,3)=cdhw_frequency(cdhw_spi_90(i,:),4);
    frequency_spi_92(i,1)=cdhw_frequency(cdhw_spi_92(i,:),2);
    frequency_spi_92(i,2)=cdhw_frequency(cdhw_spi_92(i,:),3);
    frequency_spi_92(i,3)=cdhw_frequency(cdhw_spi_92(i,:),4);
    frequency_spi_95(i,1)=cdhw_frequency(cdhw_spi_95(i,:),2);
    frequency_spi_95(i,2)=cdhw_frequency(cdhw_spi_95(i,:),3);
    frequency_spi_95(i,3)=cdhw_frequency(cdhw_spi_95(i,:),4);
    frequency_spi_97(i,1)=cdhw_frequency(cdhw_spi_97(i,:),2);
    frequency_spi_97(i,2)=cdhw_frequency(cdhw_spi_97(i,:),3);
    frequency_spi_97(i,3)=cdhw_frequency(cdhw_spi_97(i,:),4);
    frequency_spi_99(i,1)=cdhw_frequency(cdhw_spi_99(i,:),2);
    frequency_spi_99(i,2)=cdhw_frequency(cdhw_spi_99(i,:),3);
    frequency_spi_99(i,3)=cdhw_frequency(cdhw_spi_99(i,:),4);
    frequency_spei_90(i,1)=cdhw_frequency(cdhw_spei_90(i,:),2);
    frequency_spei_90(i,2)=cdhw_frequency(cdhw_spei_90(i,:),3);
    frequency_spei_90(i,3)=cdhw_frequency(cdhw_spei_90(i,:),4);
    frequency_spei_92(i,1)=cdhw_frequency(cdhw_spei_92(i,:),2);
    frequency_spei_92(i,2)=cdhw_frequency(cdhw_spei_92(i,:),3);
    frequency_spei_92(i,3)=cdhw_frequency(cdhw_spei_92(i,:),4);
    frequency_spei_95(i,1)=cdhw_frequency(cdhw_spei_95(i,:),2);
    frequency_spei_95(i,2)=cdhw_frequency(cdhw_spei_95(i,:),3);
    frequency_spei_95(i,3)=cdhw_frequency(cdhw_spei_95(i,:),4);
    frequency_spei_97(i,1)=cdhw_frequency(cdhw_spei_97(i,:),2);
    frequency_spei_97(i,2)=cdhw_frequency(cdhw_spei_97(i,:),3);
    frequency_spei_97(i,3)=cdhw_frequency(cdhw_spei_97(i,:),4);
    frequency_spei_99(i,1)=cdhw_frequency(cdhw_spei_99(i,:),2);
    frequency_spei_99(i,2)=cdhw_frequency(cdhw_spei_99(i,:),3);
    frequency_spei_99(i,3)=cdhw_frequency(cdhw_spei_99(i,:),4);
    duration_twsa_90(i,1)=cdhw_duration(cdhw_twsa_90(i,:),2);
    duration_twsa_90(i,2)=cdhw_duration(cdhw_twsa_90(i,:),3);
    duration_twsa_90(i,3)=cdhw_duration(cdhw_twsa_90(i,:),4);
    duration_twsa_92(i,1)=cdhw_duration(cdhw_twsa_92(i,:),2);
    duration_twsa_92(i,2)=cdhw_duration(cdhw_twsa_92(i,:),3);
    duration_twsa_92(i,3)=cdhw_duration(cdhw_twsa_92(i,:),4);
    duration_twsa_95(i,1)=cdhw_duration(cdhw_twsa_95(i,:),2);
    duration_twsa_95(i,2)=cdhw_duration(cdhw_twsa_95(i,:),3);
    duration_twsa_95(i,3)=cdhw_duration(cdhw_twsa_95(i,:),4);
    duration_twsa_97(i,1)=cdhw_duration(cdhw_twsa_97(i,:),2);
    duration_twsa_97(i,2)=cdhw_duration(cdhw_twsa_97(i,:),3);
    duration_twsa_97(i,3)=cdhw_duration(cdhw_twsa_97(i,:),4);
    duration_twsa_99(i,1)=cdhw_duration(cdhw_twsa_99(i,:),2);
    duration_twsa_99(i,2)=cdhw_duration(cdhw_twsa_99(i,:),3);
    duration_twsa_99(i,3)=cdhw_duration(cdhw_twsa_99(i,:),4);
    duration_spi_90(i,1)=cdhw_duration(cdhw_spi_90(i,:),2);
    duration_spi_90(i,2)=cdhw_duration(cdhw_spi_90(i,:),3);
    duration_spi_90(i,3)=cdhw_duration(cdhw_spi_90(i,:),4);
    duration_spi_92(i,1)=cdhw_duration(cdhw_spi_92(i,:),2);
    duration_spi_92(i,2)=cdhw_duration(cdhw_spi_92(i,:),3);
    duration_spi_92(i,3)=cdhw_duration(cdhw_spi_92(i,:),4);
    duration_spi_95(i,1)=cdhw_duration(cdhw_spi_95(i,:),2);
    duration_spi_95(i,2)=cdhw_duration(cdhw_spi_95(i,:),3);
    duration_spi_95(i,3)=cdhw_duration(cdhw_spi_95(i,:),4);
    duration_spi_97(i,1)=cdhw_duration(cdhw_spi_97(i,:),2);
    duration_spi_97(i,2)=cdhw_duration(cdhw_spi_97(i,:),3);
    duration_spi_97(i,3)=cdhw_duration(cdhw_spi_97(i,:),4);
    duration_spi_99(i,1)=cdhw_duration(cdhw_spi_99(i,:),2);
    duration_spi_99(i,2)=cdhw_duration(cdhw_spi_99(i,:),3);
    duration_spi_99(i,3)=cdhw_duration(cdhw_spi_99(i,:),4);
    duration_spei_90(i,1)=cdhw_duration(cdhw_spei_90(i,:),2);
    duration_spei_90(i,2)=cdhw_duration(cdhw_spei_90(i,:),3);
    duration_spei_90(i,3)=cdhw_duration(cdhw_spei_90(i,:),4);
    duration_spei_92(i,1)=cdhw_duration(cdhw_spei_92(i,:),2);
    duration_spei_92(i,2)=cdhw_duration(cdhw_spei_92(i,:),3);
    duration_spei_92(i,3)=cdhw_duration(cdhw_spei_92(i,:),4);
    duration_spei_95(i,1)=cdhw_duration(cdhw_spei_95(i,:),2);
    duration_spei_95(i,2)=cdhw_duration(cdhw_spei_95(i,:),3);
    duration_spei_95(i,3)=cdhw_duration(cdhw_spei_95(i,:),4);
    duration_spei_97(i,1)=cdhw_duration(cdhw_spei_97(i,:),2);
    duration_spei_97(i,2)=cdhw_duration(cdhw_spei_97(i,:),3);
    duration_spei_97(i,3)=cdhw_duration(cdhw_spei_97(i,:),4);
    duration_spei_99(i,1)=cdhw_duration(cdhw_spei_99(i,:),2);
    duration_spei_99(i,2)=cdhw_duration(cdhw_spei_99(i,:),3);
    duration_spei_99(i,3)=cdhw_duration(cdhw_spei_99(i,:),4);
    severity_twsa_90(i,1)=cdhw_severity(cdhw_twsa_90(i,:),2);
    severity_twsa_90(i,2)=cdhw_severity(cdhw_twsa_90(i,:),3);
    severity_twsa_90(i,3)=cdhw_severity(cdhw_twsa_90(i,:),4);
    severity_twsa_92(i,1)=cdhw_severity(cdhw_twsa_92(i,:),2);
    severity_twsa_92(i,2)=cdhw_severity(cdhw_twsa_92(i,:),3);
    severity_twsa_92(i,3)=cdhw_severity(cdhw_twsa_92(i,:),4);
    severity_twsa_95(i,1)=cdhw_severity(cdhw_twsa_95(i,:),2);
    severity_twsa_95(i,2)=cdhw_severity(cdhw_twsa_95(i,:),3);
    severity_twsa_95(i,3)=cdhw_severity(cdhw_twsa_95(i,:),4);
    severity_twsa_97(i,1)=cdhw_severity(cdhw_twsa_97(i,:),2);
    severity_twsa_97(i,2)=cdhw_severity(cdhw_twsa_97(i,:),3);
    severity_twsa_97(i,3)=cdhw_severity(cdhw_twsa_97(i,:),4);
    severity_twsa_99(i,1)=cdhw_severity(cdhw_twsa_99(i,:),2);
    severity_twsa_99(i,2)=cdhw_severity(cdhw_twsa_99(i,:),3);
    severity_twsa_99(i,3)=cdhw_severity(cdhw_twsa_99(i,:),4);
    severity_spi_90(i,1)=cdhw_severity(cdhw_spi_90(i,:),2);
    severity_spi_90(i,2)=cdhw_severity(cdhw_spi_90(i,:),3);
    severity_spi_90(i,3)=cdhw_severity(cdhw_spi_90(i,:),4);
    severity_spi_92(i,1)=cdhw_severity(cdhw_spi_92(i,:),2);
    severity_spi_92(i,2)=cdhw_severity(cdhw_spi_92(i,:),3);
    severity_spi_92(i,3)=cdhw_severity(cdhw_spi_92(i,:),4);
    severity_spi_95(i,1)=cdhw_severity(cdhw_spi_95(i,:),2);
    severity_spi_95(i,2)=cdhw_severity(cdhw_spi_95(i,:),3);
    severity_spi_95(i,3)=cdhw_severity(cdhw_spi_95(i,:),4);
    severity_spi_97(i,1)=cdhw_severity(cdhw_spi_97(i,:),2);
    severity_spi_97(i,2)=cdhw_severity(cdhw_spi_97(i,:),3);
    severity_spi_97(i,3)=cdhw_severity(cdhw_spi_97(i,:),4);
    severity_spi_99(i,1)=cdhw_severity(cdhw_spi_99(i,:),2);
    severity_spi_99(i,2)=cdhw_severity(cdhw_spi_99(i,:),3);
    severity_spi_99(i,3)=cdhw_severity(cdhw_spi_99(i,:),4);
    severity_spei_90(i,1)=cdhw_severity(cdhw_spei_90(i,:),2);
    severity_spei_90(i,2)=cdhw_severity(cdhw_spei_90(i,:),3);
    severity_spei_90(i,3)=cdhw_severity(cdhw_spei_90(i,:),4);
    severity_spei_92(i,1)=cdhw_severity(cdhw_spei_92(i,:),2);
    severity_spei_92(i,2)=cdhw_severity(cdhw_spei_92(i,:),3);
    severity_spei_92(i,3)=cdhw_severity(cdhw_spei_92(i,:),4);
    severity_spei_95(i,1)=cdhw_severity(cdhw_spei_95(i,:),2);
    severity_spei_95(i,2)=cdhw_severity(cdhw_spei_95(i,:),3);
    severity_spei_95(i,3)=cdhw_severity(cdhw_spei_95(i,:),4);
    severity_spei_97(i,1)=cdhw_severity(cdhw_spei_97(i,:),2);
    severity_spei_97(i,2)=cdhw_severity(cdhw_spei_97(i,:),3);
    severity_spei_97(i,3)=cdhw_severity(cdhw_spei_97(i,:),4);
    severity_spei_99(i,1)=cdhw_severity(cdhw_spei_99(i,:),2);
    severity_spei_99(i,2)=cdhw_severity(cdhw_spei_99(i,:),3);
    severity_spei_99(i,3)=cdhw_severity(cdhw_spei_99(i,:),4);
end


